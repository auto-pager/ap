# ap - جهاز استدعاء تلقائي

ap هي أداة مساعدة تسمح بإخراج أوامر shell الأخرى للدخول تلقائيًا إلى وضع تقليب الصفحة التفاعلي.

يتكون ap من جزأين ، برنامج ثنائي مكتوب في Go يلتقط إخراج الأوامر ويدعم تقليب الصفحة ، ومجموعة من نصوص shell التي تنشئ غلافًا يحمل نفس الاسم لقائمة أوامر محددة من قبل المستخدم.

استخدام الأوامر بعد الالتفاف هو نفسه كما كان من قبل ، ويجب ألا يغير عادات المستخدم أو يسبب أي مشاكل.

\* اقرأ هذا بلغات أخرى:[إنجليزي](README_en.md),[الصينية المبسطة](README.md)

ap هي أداة shell التي تتيح إخراج أوامر shell الأخرى للدخول تلقائيًا إلى وضع الترحيل التفاعلي.

يتكون ap من جزأين ، برنامج ثنائي مكتوب بلغة Go ، مسؤول عن التقاط إخراج الأمر ودعم تقليب الصفحة ،
ومجموعة من البرامج النصية للقشرة المسؤولة عن إنشاء غلاف يحمل نفس الاسم لقائمة أوامر يحددها المستخدم.

استخدام الأمر بعد الالتفاف هو نفسه كما كان من قبل ، ولا ينبغي أن يغير عادات التشغيل للمستخدم ، ولن يسبب مشكلة للمستخدم.

## ثبت

    go install github.com/flw-cn/ap@master

## تهيئة

-   [سحق](#bash)
-   [سمك](#fish)
-   [zsh](#zsh)

### سحق

على الخاص بك`~/.bashrc`يضاف إليها ما يلي:

```sh
eval "$(ap --bash)"
```

يلف ap مجموعة من الأوامر بشكل افتراضي. إذا لم تكن راضيًا ، يمكنك إعادة تخصيصه من خلال متغيرات البيئة:

```sh
AUTO_PAGER_CMDS=(go cargo make)
eval "$(ap --bash)"
```

أو قم فقط بإضافة أوامر جديدة أعلى القائمة الافتراضية:

```sh
AUTO_PAGER_CMDS_EXTRA=(ps last)
eval "$(ap --bash)"
```

بالإضافة إلى ذلك ، يمكن أيضًا استخدام ap مع[grc](https://github.com/garabik/grc)بالعمل معًا ، يمكن تثبيت grc باستخدام Homebrew ضمن macOS:

```sh
brew install grc
```

يلف ap + grc مجموعة من الأوامر افتراضيًا. إذا لم تكن راضيًا ، يمكنك إعادة تخصيصه من خلال متغيرات البيئة:

```sh
AUTO_PAGER_CMDS_WITH_GRC=(ps last dig diff)
eval "$(ap --bash)"
```

或者也可只在默认清单之上增加新的命令：

```sh
AUTO_PAGER_CMDS_WITH_GRC_EXTRA=(ps last)
eval "$(ap --bash)"
```

أيضا ، متغيرات البيئة`$AUTO_PAGER_MIN_HEIGHT`يمكنك التحكم في الحد الأدنى لعدد الأسطر لبدء الترحيل:

```sh
AUTO_PAGER_MIN_HEIGHT=30        # 输出超过 30 行时才开始分页
eval "$(ap --bash)"
```

إذا تم تكوينه كرقم سالب ، فإنه يمثل نسبة مئوية من ارتفاع النافذة الطرفية:

```sh
AUTO_PAGER_MIN_HEIGHT='-50'     # 输出超过终端窗口高度的 50% 时才开始分页
eval "$(ap --bash)"
```

إذا لم يتم تحديدها`AUTO_PAGER_MIN_HEIGHT`، الافتراضي هو`-80`،الآن`80%`。

### سمك

على الخاص بك`~/.config/fish/config.fish`يضاف إليها ما يلي:

```sh
ap --fish | source
```

يلف ap مجموعة من الأوامر بشكل افتراضي. إذا لم تكن راضيًا ، يمكنك إعادة تخصيصه من خلال متغيرات البيئة:

```sh
set AUTO_PAGER_CMDS go cargo make
ap --fish | source
```

أو قم فقط بإضافة أوامر جديدة أعلى القائمة الافتراضية:

```sh
set AUTO_PAGER_CMDS_EXTRA ps last
ap --fish | source
```

بالإضافة إلى ذلك ، يمكن أيضًا استخدام ap مع[grc](https://github.com/garabik/grc)بالعمل معًا ، يمكن تثبيت grc باستخدام Homebrew ضمن macOS:

```sh
brew install grc
```

يلف ap + grc مجموعة من الأوامر افتراضيًا. إذا لم تكن راضيًا ، يمكنك إعادة تخصيصه من خلال متغيرات البيئة:

```sh
set AUTO_PAGER_CMDS_WITH_GRC ps last dig diff
ap --fish | source
```

أو قم فقط بإضافة أوامر جديدة أعلى القائمة الافتراضية:

```sh
set AUTO_PAGER_CMDS_WITH_GRC_EXTRA ps last
ap --fish | source
```

أيضا ، متغيرات البيئة`$AUTO_PAGER_MIN_HEIGHT`يمكنك التحكم في الحد الأدنى لعدد الأسطر لبدء الترحيل:

```sh
set AUTO_PAGER_MIN_HEIGHT 30        # 输出超过 30 行时才开始分页
ap --fish | source
```

إذا تم تكوينه كرقم سالب ، فإنه يمثل نسبة مئوية من ارتفاع النافذة الطرفية:

```sh
set AUTO_PAGER_MIN_HEIGHT -50     # 输出超过终端窗口高度的 50% 时才开始分页
ap --fish | source
```

إذا لم يتم تحديدها`AUTO_PAGER_MIN_HEIGHT`، الافتراضي هو`-80`،الآن`80%`。

### zsh

على الخاص بك`~/.zshrc`يضاف إليها ما يلي:

```sh
eval "$(ap --zsh)"
```

يلف ap مجموعة من الأوامر بشكل افتراضي. إذا لم تكن راضيًا ، يمكنك إعادة تخصيصه من خلال متغيرات البيئة:

```sh
AUTO_PAGER_CMDS=(go cargo make)
eval "$(ap --zsh)"
```

أو قم فقط بإضافة أوامر جديدة أعلى القائمة الافتراضية:

```sh
AUTO_PAGER_CMDS_EXTRA=(ps last)
eval "$(ap --zsh)"
```

بالإضافة إلى ذلك ، يمكن أيضًا استخدام ap مع[grc](https://github.com/garabik/grc)بالعمل معًا ، يمكن تثبيت grc باستخدام Homebrew ضمن macOS:

```sh
brew install grc
```

يلف ap + grc مجموعة من الأوامر افتراضيًا. إذا لم تكن راضيًا ، يمكنك إعادة تخصيصه من خلال متغيرات البيئة:

```sh
AUTO_PAGER_CMDS_WITH_GRC=(ps last dig diff)
eval "$(ap --zsh)"
```

أو قم فقط بإضافة أوامر جديدة أعلى القائمة الافتراضية:

```sh
AUTO_PAGER_CMDS_WITH_GRC_EXTRA=(ps last)
eval "$(ap --zsh)"
```

أيضا ، متغيرات البيئة`$AUTO_PAGER_MIN_HEIGHT`يمكنك التحكم في الحد الأدنى لعدد الأسطر لبدء الترحيل:

```sh
AUTO_PAGER_MIN_HEIGHT=30        # 输出超过 30 行时才开始分页
eval "$(ap --zsh)"
```

إذا تم تكوينه كرقم سالب ، فإنه يمثل نسبة مئوية من ارتفاع النافذة الطرفية:

```sh
AUTO_PAGER_MIN_HEIGHT='-50'     # 输出超过终端窗口高度的 50% 时才开始分页
eval "$(ap --zsh)"
```

إذا لم يتم تحديدها`AUTO_PAGER_MIN_HEIGHT`، الافتراضي هو`-80`،الآن`80%`。

## استعمال

الأوامر التي خضعت للالتفاف ap تحتاج فقط إلى استخدامها كالمعتاد.
إذا كان هناك الكثير من المخرجات ، فسيتم استدعاء متغير البيئة تلقائيًا`$PAGER`ينفذ جهاز النداء المحدد ترقيم الصفحات.

إذا كان لديك`$PAGER`المتغيرات خاصة ولا يمكن تكييفها مع تطبيق AP ، كما يمكنك تمرير متغيرات البيئة`$AP_PAGER`تعيين النداء بشكل منفصل لـ ap.

إذا`$AP_PAGER`و`$PAGER`لم يتم تحديدها ، ثم سوف تستخدم`less -Fr`。

لن يبدأ جهاز النداء إذا:

-   输出内容过少时，参见 `$AUTO_PAGER_MIN_HEIGHT`。
-   عندما يكتشف ap أن إخراج الأمر يحتوي على`ESC [?1049h`التسلسل ، يتم تحديد الأمر ليكون تطبيق ملء الشاشة.
-   عندما لم يتم تنفيذ الأمر بعد. لا يبدأ النداء حتى يكتمل تنفيذ الأمر.
    -   `ping`و`tcpdump`وغيرها من الأوامر ، تحتاج إلى الضغط`Ctrl-C`لا يبدأ الترحيل حتى أمر الإنهاء.
    -   `python`و`gdb`تحتاج هذه الأوامر إلى انتظار خروج الأمر قبل بدء الترحيل.

## مشكلة شائعة

-   هل سيؤثر على الإخراج الملون للأمر؟
    -   سوف لن.
-   هناك بعض الأوامر التي تكتشف المحطة وتعطي مخرجات مختلفة للوضع الطرفي والوضع غير الطرفي ، فهل ستغير ناتجها؟
    -   سوف لن.
-   كيف يمكنني تشخيص ما إذا كنت أشك في أن ap يؤثر على إخراج الأمر؟
    -   你可以用 `command foo`ينفذ`foo`، لذلك لم يتم استدعاء هذا التطبيق.
-   إذا كنت عادةً ألحق الأمر بأمر ap`| less`هل ستكون هناك مشكلة؟
    -   سوف لن.
-   هل يمكن لأمر ap أيضًا إعادة توجيه مخرجاته؟
    -   علبة.
-   هل سيتم تعطيل الإكمال التلقائي لأوامر AP؟
    -   سوف لن.
-   يدعم ap أشياء مثل`python`、`gdb`مثل هذا التطبيق التفاعلي؟
    -   الدعم. ولكن نظرًا لأن هذه التطبيقات تُخرج بعض أحرف التحكم ، فإن المحتوى الذي تراه بعد الترحيل يمكن أن يكون فوضويًا بعض الشيء.
-   يدعم ap أشياء مثل`htop`、`vim`تطبيق ملء الشاشة مثل هذا؟
    -   كيف أقول ، لا يمكن أن تخطئ على أي حال ، لكن لا يمكنني معرفة النقطة العملية من الاقتران بهم.
